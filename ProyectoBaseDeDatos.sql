DROP TABLE SERVICIOS_FACTURAS;
DROP TABLE FACTURAS;
DROP TABLE SERVICIOS;
DROP TABLE CATEGORIAS_SERVICIOS;
DROP TABLE CLIENTES;
DROP TABLE CLIENTES_LOG;

----------------------------------------------------------------------------------------------------------
------ 11.5 b - CREACION DE TABLAS CON LAS RESTRICCIONES ADECUADAS -------
----------------------------------------------------------------------------------------------------------

ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD';

CREATE TABLE CLIENTES (
    ID_CLIENTE NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    DNI VARCHAR2(9) NOT NULL,
    NOMBRE VARCHAR2(15) NOT NULL,
    APELLIDOS VARCHAR2(30) NOT NULL,
    DIRECCION VARCHAR2(50) NOT NULL,
    TELEFONO NUMBER(9) NOT NULL,
    EMAIL VARCHAR2(30) NOT NULL,
    FECHA_REGISTRO DATE NOT NULL,
    ESTADO_CLIENTE VARCHAR2(15) NOT NULL CHECK (ESTADO_CLIENTE IN ('Activo', 'Inactivo'))
);

CREATE TABLE CATEGORIAS_SERVICIOS (
    ID_CATEGORIA NUMBER PRIMARY KEY,
    NOMBRE_CATEGORIA VARCHAR2(50) NOT NULL
);

CREATE TABLE SERVICIOS (
    ID_SERVICIO NUMBER PRIMARY KEY,
    NOMBRE_SERVICIO VARCHAR2(30) NOT NULL,
    DESCRIPCION VARCHAR2(200) NOT NULL,
    PRECIO NUMBER(5, 2) NOT NULL,
    ID_CATEGORIA NUMBER,
    FOREIGN KEY (ID_CATEGORIA) REFERENCES CATEGORIAS_SERVICIOS(ID_CATEGORIA)
);

CREATE TABLE FACTURAS (
    ID_FACTURA NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ID_CLIENTE NUMBER,
    FECHA_EMISION DATE NOT NULL,
    FECHA_VENCIMIENTO DATE NOT NULL,
    PRECIO_TOTAL NUMBER(6, 2) NOT NULL,
    ESTADO VARCHAR2(15) NOT NULL CHECK (ESTADO IN ('Pagada', 'Pendiente')),
    FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTES(ID_CLIENTE)
);

CREATE TABLE SERVICIOS_FACTURAS (
    ID_SERVICIO_FACTURA NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ID_FACTURA NUMBER,
    ID_SERVICIO NUMBER,
    FOREIGN KEY (ID_FACTURA) REFERENCES FACTURAS(ID_FACTURA),
    FOREIGN KEY (ID_SERVICIO) REFERENCES SERVICIOS(ID_SERVICIO)
);

--------------------------------------------------------------------------------------------------
------ 11.5 c - INSERCION DE DATOS MEDIANTE PROCEDIMIENTOS -------
--------------------------------------------------------------------------------------------------

/* PROCEDIMIENTOS INSERCION CLIENTES */

CREATE OR REPLACE PROCEDURE INSERTAR_CLIENTES IS
    TYPE DNI_ARRAY IS TABLE OF VARCHAR2(9);
    TYPE NOMBRE_ARRAY IS TABLE OF VARCHAR2(15);
    TYPE APELLIDOS_ARRAY IS TABLE OF VARCHAR2(30);
    TYPE DIRECCION_ARRAY IS TABLE OF VARCHAR2(50);
    TYPE TELEFONO_ARRAY IS TABLE OF NUMBER(9);
    TYPE EMAIL_ARRAY IS TABLE OF VARCHAR2(30);
    TYPE FECHA_REGISTRO_ARRAY IS TABLE OF DATE;
    TYPE ESTADO_CLIENTE_ARRAY IS TABLE OF VARCHAR2(15);

    v_dni DNI_ARRAY := DNI_ARRAY(
        '33344455O', '99911133Y', '44455566P', 'X0022244P', '55566677Q', '44466688T', '22233344H', '66688800L', 
        '66688800V', '33344455I', 'X4455566Z', '55566677K', '00022244F', 'X8899900T', '77788899M', '88899900N', 
        '22244466R', '00011122F', 'X0011122P', '11122233W'
    );

    v_nombre NOMBRE_ARRAY := NOMBRE_ARRAY(
        'Isabel', 'Elena', 'Javier', 'Miguel', 'Laura', 'Carmen', 'Teresa', 'Javier', 'Laura', 'Carlos', 'Fernando', 
        'Alberto', 'Héctor', 'Sergio', 'Pablo', 'Marta', 'Juan', 'Raúl', 'Laura', 'Elisa'
    );

    v_apellidos APELLIDOS_ARRAY := APELLIDOS_ARRAY(
        'Moreno López', 'Pérez Fernández', 'Ortiz Díaz', 'Hernández Ruiz', 'Martínez Núñez', 'Ortiz López', 'López Jiménez', 
        'Flores Sánchez', 'Díaz Fernández', 'Martínez García', 'Domínguez Gil', 'Ortiz López', 'Muñoz Ruiz', 'Blanco Gómez', 
        'Santos Muñoz', 'Díaz Fernández', 'Martínez García', 'Fernández Díaz', 'López Jiménez', 'Cortés Jiménez'
    );

    v_direccion DIRECCION_ARRAY := DIRECCION_ARRAY(
        'Calle Primavera 7', 'Av. Tierra 271', 'Av. Libertad 12', 'Calle Río 171', 'Plaza Viento 22', 'Av. Trueno 211', 
        'Av. Mar 181', 'Av. Cielo 121', 'Av. Sol 241', 'Plaza Fuego 191', 'Plaza Sol 101', 'Av. Trueno 211', 'Calle Sur 51', 
        'Plaza Norte 42', 'Calle Aurora 231', 'Av. Sol 241', 'Plaza Fuego 191', 'Plaza Monte 161', 'Calle Viento 261', 
        'Plaza Oeste 71'
    );

    v_telefono TELEFONO_ARRAY := TELEFONO_ARRAY(
        610123456, 698567890, 611234567, 689678901, 612345678, 693012345, 629012345, 685234567, 695234567, 630123456, 
        621234567, 632345678, 679678901, 615678901, 634567890, 635678901, 691890123, 627890123, 637890123, 618901234
    );

    v_email EMAIL_ARRAY := EMAIL_ARRAY(
        'isabel.moreno@gmail.com', 'elena.perez@outlook.com', 'javier.ortiz@hotmail.com', 'miguel.hernandez@outlook.com', 
        'laura.martinez@yahoo.com', 'carmen.ortiz@yahoo.com', 'teresa.lopez@protonmail.com', 'javier.flores@outlook.com', 
        'laura.diaz@gmail.com', 'carlos.martinez@gmail.com', 'fernando.dominguez@hotmail.com', 'alberto.ortiz@yahoo.com', 
        'hector.munoz@hotmail.com', 'sergio.blanco@gmail.com', 'pablo.santos@protonmail.com', 'marta.diaz@gmail.com', 
        'juan.martinez@gmail.com', 'raul.fernandez@yahoo.com', 'laura.lopez@yahoo.com', 'elisa.cortes@outlook.com'
    );

    v_fecha_registro FECHA_REGISTRO_ARRAY := FECHA_REGISTRO_ARRAY(
        TO_DATE('2023-01-15', 'YYYY-MM-DD'), TO_DATE('2023-02-20', 'YYYY-MM-DD'), TO_DATE('2023-03-18', 'YYYY-MM-DD'), 
        TO_DATE('2023-04-22', 'YYYY-MM-DD'), TO_DATE('2023-05-10', 'YYYY-MM-DD'), TO_DATE('2023-05-30', 'YYYY-MM-DD'), 
        TO_DATE('2023-06-05', 'YYYY-MM-DD'), TO_DATE('2023-06-14', 'YYYY-MM-DD'), TO_DATE('2023-06-20', 'YYYY-MM-DD'), 
        TO_DATE('2023-07-10', 'YYYY-MM-DD'), TO_DATE('2023-08-14', 'YYYY-MM-DD'), TO_DATE('2023-09-20', 'YYYY-MM-DD'), 
        TO_DATE('2023-10-01', 'YYYY-MM-DD'), TO_DATE('2023-11-19', 'YYYY-MM-DD'), TO_DATE('2023-12-05', 'YYYY-MM-DD'), 
        TO_DATE('2024-01-05', 'YYYY-MM-DD'), TO_DATE('2024-02-05', 'YYYY-MM-DD'), TO_DATE('2024-03-05', 'YYYY-MM-DD'), 
        TO_DATE('2024-03-20', 'YYYY-MM-DD'), TO_DATE('2024-04-09', 'YYYY-MM-DD')
    );

    v_estado_cliente ESTADO_CLIENTE_ARRAY := ESTADO_CLIENTE_ARRAY(
        'Activo', 'Activo', 'Inactivo', 'Activo', 'Inactivo', 'Activo', 'Activo', 'Activo', 'Activo', 'Activo', 
        'Activo', 'Activo', 'Activo', 'Activo', 'Inactivo', 'Activo', 'Activo', 'Activo', 'Activo', 'Activo'
    );

BEGIN
    --FOR i IN 1..v_dni.COUNT LOOP
    FOR i IN v_dni.FIRST .. v_dni.LAST LOOP
        INSERT INTO CLIENTES (DNI, NOMBRE, APELLIDOS, DIRECCION, TELEFONO, EMAIL, FECHA_REGISTRO, ESTADO_CLIENTE) VALUES
            (v_dni(i), v_nombre(i), v_apellidos(i), v_direccion(i), v_telefono(i), v_email(i), v_fecha_registro(i), v_estado_cliente(i));
    END LOOP;

    COMMIT;
END INSERTAR_CLIENTES;
/



/* PROCEDIMIENTOS INSERCION CATEGORIAS_SERVICIOS */

CREATE OR REPLACE PROCEDURE INSERTAR_CATEGORIAS_SERVICIOS IS
    TYPE ID_CATEGORIA_ARRAY IS TABLE OF NUMBER;
    TYPE NOMBRE_CATEGORIA_ARRAY IS TABLE OF VARCHAR2(50);

    v_id_categoria ID_CATEGORIA_ARRAY := ID_CATEGORIA_ARRAY(1, 2, 3);
    v_nombre_categoria NOMBRE_CATEGORIA_ARRAY := NOMBRE_CATEGORIA_ARRAY('Internet', 'Movil', 'Telefono Fijo');

BEGIN
    FOR i IN v_id_categoria.FIRST .. v_id_categoria.LAST LOOP
        INSERT INTO CATEGORIAS_SERVICIOS (ID_CATEGORIA, NOMBRE_CATEGORIA) VALUES
            (v_id_categoria(i), v_nombre_categoria(i));
    END LOOP;

    COMMIT;
END INSERTAR_CATEGORIAS_SERVICIOS;
/


/* PROCEDIMIENTOS INSERCION SERVICIOS */

CREATE OR REPLACE PROCEDURE INSERTAR_SERVICIOS IS
    TYPE ID_SERVICIO_ARRAY IS TABLE OF NUMBER;
    TYPE NOMBRE_SERVICIO_ARRAY IS TABLE OF VARCHAR2(30);
    TYPE DESCRIPCION_ARRAY IS TABLE OF VARCHAR2(200);
    TYPE PRECIO_ARRAY IS TABLE OF NUMBER(5, 2);
    TYPE ID_CATEGORIA_ARRAY IS TABLE OF NUMBER;

    v_id_servicio ID_SERVICIO_ARRAY := ID_SERVICIO_ARRAY(1, 2, 3, 4, 5, 6, 7);
    v_nombre_servicio NOMBRE_SERVICIO_ARRAY := NOMBRE_SERVICIO_ARRAY(
        'Fibra300', 'Fibra600', 'Fibra1000', 'Movil Ilimitado + 1Gb', 'Movil Ilimitado + 30Gb', 'Movil Ilimitado total', 'Telefono Fijo'
    );
    v_descripcion DESCRIPCION_ARRAY := DESCRIPCION_ARRAY(
        'Servicio de internet por fibra optica con velocidad de 300 Mbps', 
        'Servicio de internet por fibra optica con velocidad de 600 Mbps', 
        'Servicio de internet por fibra optica con velocidad de 1000 Mbps', 
        'Tarifa movil con llamadas ilimitadas y 1Gb de datos', 
        'Tarifa movil con llamadas ilimitadas y 30Gb de datos', 
        'Tarifa movil con llamadas ilimitadas y datos ilimitados', 
        'Servicio de telefono fijo ilimitado'
    );
    v_precio PRECIO_ARRAY := PRECIO_ARRAY(29.99, 49.99, 69.99, 10.99, 19.99, 24.99, 9.99);
    v_id_categoria ID_CATEGORIA_ARRAY := ID_CATEGORIA_ARRAY(1, 1, 1, 2, 2, 2, 3);

BEGIN
    FOR i IN v_id_servicio.FIRST .. v_id_servicio.LAST LOOP
        INSERT INTO SERVICIOS (ID_SERVICIO, NOMBRE_SERVICIO, DESCRIPCION, PRECIO, ID_CATEGORIA) VALUES
            (v_id_servicio(i), v_nombre_servicio(i), v_descripcion(i), v_precio(i), v_id_categoria(i));
    END LOOP;

    COMMIT;
END INSERTAR_SERVICIOS;
/


/* PROCEDIMIENTOS INSERCION FACTURAS */

CREATE OR REPLACE PROCEDURE INSERTAR_FACTURAS IS

BEGIN
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (1, '2023-02-15', '2023-02-28', 50.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (1, '2023-03-15', '2023-03-31', 50.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (1, '2023-04-15', '2023-04-30', 50.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (1, '2023-05-15', '2023-05-31', 50.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (1, '2023-06-15', '2023-06-30', 50.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (1, '2023-07-15', '2023-07-31', 50.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (1, '2023-08-15', '2023-08-31', 50.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (1, '2023-09-15', '2023-09-30', 50.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (1, '2023-10-15', '2023-10-31', 50.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (1, '2023-11-15', '2023-11-30', 50.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (1, '2023-12-15', '2023-12-31', 50.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (1, '2024-01-15', '2024-01-31', 50.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (1, '2024-02-15', '2024-02-28', 50.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (1, '2024-03-15', '2024-03-31', 50.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (1, '2024-04-15', '2024-04-30', 50.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (1, '2024-05-15', '2024-05-31', 50.97, 'Pendiente');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (2, '2023-03-15', '2023-03-31', 69.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (2, '2023-04-15', '2023-04-30', 69.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (2, '2023-05-15', '2023-05-31', 69.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (2, '2023-06-15', '2023-06-30', 69.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (2, '2023-07-15', '2023-07-31', 69.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (2, '2023-08-15', '2023-08-31', 69.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (2, '2023-09-15', '2023-09-30', 69.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (2, '2023-10-15', '2023-10-31', 69.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (2, '2023-11-15', '2023-11-30', 69.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (2, '2023-12-15', '2023-12-31', 69.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (2, '2024-01-15', '2024-01-31', 69.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (2, '2024-02-15', '2024-02-28', 69.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (2, '2024-03-15', '2024-03-31', 69.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (2, '2024-04-15', '2024-04-30', 69.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (2, '2024-05-15', '2024-05-31', 69.98, 'Pendiente');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (3, '2023-04-15', '2023-04-30', 91.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (3, '2023-05-15', '2023-05-31', 91.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (3, '2023-06-15', '2023-06-30', 91.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (3, '2023-07-15', '2023-07-31', 91.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (3, '2023-08-15', '2023-08-31', 91.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (3, '2023-09-15', '2023-09-30', 91.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (3, '2023-10-15', '2023-10-31', 91.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (3, '2023-11-15', '2023-11-30', 91.97, 'Pendiente');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (3, '2023-12-15', '2023-12-31', 91.97, 'Pendiente');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (3, '2024-01-15', '2024-01-31', 91.97, 'Pendiente');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (4, '2023-05-15', '2023-05-31', 94.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (4, '2023-06-15', '2023-06-30', 94.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (4, '2023-07-15', '2023-07-31', 94.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (4, '2023-08-15', '2023-08-31', 94.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (4, '2023-09-15', '2023-09-30', 94.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (4, '2023-10-15', '2023-10-31', 94.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (4, '2023-11-15', '2023-11-30', 94.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (4, '2023-12-15', '2023-12-31', 94.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (4, '2024-01-15', '2024-01-31', 94.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (4, '2024-02-15', '2024-02-28', 94.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (4, '2024-03-15', '2024-03-31', 94.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (4, '2024-04-15', '2024-04-30', 94.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (4, '2024-05-15', '2024-05-31', 94.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (5, '2023-06-15', '2023-06-30', 69.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (5, '2023-07-15', '2023-07-31', 69.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (5, '2023-08-15', '2023-08-31', 69.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (5, '2023-09-15', '2023-09-30', 69.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (5, '2023-10-15', '2023-10-31', 69.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (5, '2023-11-15', '2023-11-30', 69.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (6, '2023-06-15', '2023-06-30', 61.96, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (6, '2023-07-15', '2023-07-31', 61.96, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (6, '2023-08-15', '2023-08-31', 61.96, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (6, '2023-09-15', '2023-09-30', 61.96, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (6, '2023-10-15', '2023-10-31', 61.96, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (6, '2023-11-15', '2023-11-30', 61.96, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (6, '2023-12-15', '2023-12-31', 61.96, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (6, '2024-01-15', '2024-01-31', 61.96, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (6, '2024-02-15', '2024-02-28', 61.96, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (6, '2024-03-15', '2024-03-31', 61.96, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (6, '2024-04-15', '2024-04-30', 61.96, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (6, '2024-05-15', '2024-05-31', 61.96, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (7, '2023-06-15', '2023-06-30', 71.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (7, '2023-07-15', '2023-07-31', 71.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (7, '2023-08-15', '2023-08-31', 71.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (7, '2023-09-15', '2023-09-30', 71.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (7, '2023-10-15', '2023-10-31', 71.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (7, '2023-11-15', '2023-11-30', 71.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (7, '2023-12-15', '2023-12-31', 71.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (7, '2024-01-15', '2024-01-31', 71.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (7, '2024-02-15', '2024-02-28', 71.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (7, '2024-03-15', '2024-03-31', 91.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (7, '2024-04-15', '2024-04-30', 91.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (7, '2024-05-15', '2024-05-31', 91.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (8, '2023-07-15', '2023-07-31', 64.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (8, '2023-08-15', '2023-08-31', 64.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (8, '2023-09-15', '2023-09-30', 64.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (8, '2023-10-15', '2023-10-31', 64.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (8, '2023-11-15', '2023-11-30', 64.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (8, '2023-12-15', '2023-12-31', 114.96, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (8, '2024-01-15', '2024-01-31', 114.96, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (8, '2024-02-15', '2024-02-28', 114.96, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (8, '2024-03-15', '2024-03-31', 114.96, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (8, '2024-04-15', '2024-04-30', 114.96, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (8, '2024-05-15', '2024-05-31', 114.96, 'Pendiente');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (9, '2023-07-15', '2023-07-31', 39.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (9, '2023-08-15', '2023-08-31', 39.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (9, '2023-09-15', '2023-09-30', 39.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (9, '2023-10-15', '2023-10-31', 39.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (9, '2023-11-15', '2023-11-30', 39.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (9, '2023-12-15', '2023-12-31', 39.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (9, '2024-01-15', '2024-01-31', 39.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (9, '2024-02-15', '2024-02-28', 75.96, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (9, '2024-03-15', '2024-03-31', 75.96, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (9, '2024-04-15', '2024-04-30', 75.96, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (9, '2024-05-15', '2024-05-31', 75.96, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (10, '2023-08-15', '2023-08-30', 9.99, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (10, '2023-09-15', '2023-09-30', 9.99, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (10, '2023-10-15', '2023-10-31', 9.99, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (10, '2023-11-15', '2023-11-30', 9.99, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (10, '2023-12-15', '2023-12-31', 9.99, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (10, '2024-01-15', '2024-01-31', 9.99, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (10, '2024-02-15', '2024-02-28', 9.99, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (10, '2024-03-15', '2024-03-31', 9.99, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (10, '2024-04-15', '2024-04-30', 9.99, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (10, '2024-05-15', '2024-05-31', 9.99, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (11, '2023-09-15', '2023-09-30', 34.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (11, '2023-10-15', '2023-10-31', 34.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (11, '2023-11-15', '2023-11-30', 34.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (11, '2023-12-15', '2023-12-31', 34.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (11, '2024-01-15', '2024-01-31', 34.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (11, '2024-02-15', '2024-02-28', 34.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (11, '2024-03-15', '2024-03-31', 34.98, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (11, '2024-04-15', '2024-04-30', 34.98, 'Pendiente');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (11, '2024-05-15', '2024-05-31', 34.98, 'Pendiente');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (12, '2023-10-15', '2023-10-31', 60.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (12, '2023-11-15', '2023-11-30', 60.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (12, '2023-12-15', '2023-12-31', 60.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (12, '2024-01-15', '2024-01-31', 60.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (12, '2024-02-15', '2024-02-28', 60.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (12, '2024-03-15', '2024-03-31', 60.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (12, '2024-04-15', '2024-04-30', 60.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (12, '2024-05-15', '2024-05-31', 60.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (13, '2023-11-15', '2023-11-30', 71.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (13, '2023-12-15', '2023-12-31', 71.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (13, '2024-01-15', '2024-01-31', 71.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (13, '2024-02-15', '2024-02-28', 71.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (13, '2024-03-15', '2024-03-31', 71.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (13, '2024-04-15', '2024-04-30', 71.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (13, '2024-05-15', '2024-05-31', 71.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (14, '2023-12-15', '2023-12-31', 114.96, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (14, '2024-01-15', '2024-01-31', 114.96, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (14, '2024-02-15', '2024-02-28', 114.96, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (14, '2024-03-15', '2024-03-31', 114.96, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (14, '2024-04-15', '2024-04-30', 114.96, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (14, '2024-05-15', '2024-05-31', 114.96, 'Pendiente');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (15, '2024-01-15', '2024-01-31', 119.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (15, '2024-02-15', '2024-02-28', 119.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (15, '2024-03-15', '2024-03-31', 119.97, 'Pendiente');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (15, '2024-04-15', '2024-04-30', 119.97, 'Pendiente');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (16, '2024-02-15', '2024-02-28', 69.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (16, '2024-03-15', '2024-03-31', 69.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (16, '2024-04-15', '2024-04-30', 69.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (16, '2024-05-15', '2024-05-31', 69.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (17, '2024-03-15', '2024-03-31', 104.96, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (17, '2024-04-15', '2024-04-30', 104.96, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (17, '2024-05-15', '2024-05-31', 104.96, 'Pendiente');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (18, '2024-04-15', '2024-04-30', 79.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (18, '2024-05-15', '2024-05-31', 79.97, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (19, '2024-04-15', '2024-04-30', 101.96, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (19, '2024-05-15', '2024-05-31', 101.96, 'Pagada');
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (20, '2024-05-15', '2024-05-31', 104.95, 'Pendiente');
END INSERTAR_FACTURAS;
/


/* PROCEDIMIENTOS INSERCION SERVICIOS_FACTURAS */

CREATE OR REPLACE PROCEDURE INSERTAR_SERVICIOS_FACTURAS AS

BEGIN
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (1, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (1, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (1, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (2, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (2, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (2, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (3, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (3, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (3, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (4, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (4, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (4, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (5, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (5, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (5, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (6, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (6, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (6, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (7, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (7, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (7, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (8, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (8, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (8, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (9, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (9, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (9, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (10, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (10, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (10, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (11, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (11, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (11, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (12, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (12, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (12, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (13, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (13, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (13, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (14, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (14, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (14, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (15, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (15, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (15, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (16, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (16, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (16, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (17, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (17, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (18, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (18, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (19, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (19, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (20, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (20, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (21, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (21, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (22, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (22, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (23, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (23, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (24, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (24, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (25, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (25, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (26, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (27, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (27, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (28, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (28, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (29, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (29, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (30, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (30, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (31, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (31, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (32, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (32, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (32, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (33, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (33, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (33, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (34, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (34, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (34, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (35, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (35, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (35, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (36, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (36, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (36, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (37, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (37, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (37, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (38, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (38, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (38, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (39, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (39, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (39, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (40, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (40, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (40, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (41, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (41, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (41, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (42, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (42, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (43, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (43, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (44, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (44, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (45, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (45, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (46, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (46, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (47, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (47, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (48, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (48, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (49, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (49, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (50, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (50, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (51, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (51, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (52, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (52, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (53, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (53, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (54, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (54, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (55, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (55, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (55, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (56, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (56, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (56, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (57, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (57, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (57, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (58, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (58, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (58, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (59, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (59, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (59, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (60, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (60, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (60, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (61, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (61, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (61, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (61, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (62, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (62, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (62, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (62, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (63, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (63, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (63, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (63, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (64, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (64, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (64, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (64, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (65, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (65, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (65, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (65, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (66, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (66, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (66, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (66, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (67, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (67, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (67, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (67, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (68, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (68, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (68, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (68, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (69, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (69, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (69, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (69, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (70, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (70, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (70, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (70, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (71, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (71, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (71, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (71, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (72, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (72, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (72, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (72, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (73, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (73, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (73, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (74, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (74, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (74, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (75, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (75, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (75, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (76, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (76, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (76, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (77, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (77, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (77, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (78, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (78, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (78, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (79, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (79, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (79, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (80, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (80, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (80, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (81, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (81, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (81, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (82, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (82, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (82, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (83, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (83, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (83, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (84, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (84, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (84, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (85, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (85, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (85, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (86, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (86, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (86, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (87, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (87, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (87, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (88, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (88, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (88, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (89, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (89, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (89, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (90, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (90, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (90, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (90, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (91, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (91, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (91, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (91, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (92, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (92, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (92, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (92, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (93, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (93, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (93, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (93, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (94, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (94, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (94, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (94, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (95, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (95, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (95, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (95, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (96, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (96, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (97, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (97, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (98, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (98, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (99, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (99, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (100, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (100, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (101, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (101, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (102, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (102, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (103, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (103, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (103, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (103, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (104, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (104, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (104, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (104, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (105, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (105, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (105, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (105, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (106, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (106, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (106, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (106, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (107, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (108, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (109, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (110, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (111, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (112, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (113, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (114, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (115, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (116, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (117, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (117, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (118, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (118, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (119, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (119, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (120, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (120, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (121, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (121, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (122, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (122, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (123, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (123, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (124, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (124, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (125, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (125, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (126, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (126, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (126, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (127, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (127, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (127, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (128, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (128, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (128, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (129, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (129, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (129, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (130, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (130, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (130, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (131, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (131, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (131, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (132, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (132, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (132, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (133, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (133, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (133, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (134, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (134, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (134, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (135, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (135, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (135, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (136, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (136, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (136, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (137, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (137, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (137, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (138, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (138, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (138, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (139, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (139, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (139, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (140, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (140, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (140, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (141, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (141, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (141, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (141, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (142, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (142, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (142, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (142, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (143, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (143, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (143, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (143, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (144, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (144, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (144, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (144, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (145, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (145, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (145, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (145, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (146, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (146, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (146, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (146, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (147, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (147, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (147, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (148, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (148, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (148, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (149, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (149, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (149, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (150, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (150, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (150, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (151, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (151, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (151, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (152, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (152, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (152, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (153, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (153, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (153, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (154, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (154, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (154, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (155, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (155, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (155, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (155, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (156, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (156, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (156, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (156, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (157, 2);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (157, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (157, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (157, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (158, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (158, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (158, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (159, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (159, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (159, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (160, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (160, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (160, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (160, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (161, 3);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (161, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (161, 4);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (161, 7);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (162, 1);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (162, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (162, 5);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (162, 6);
    INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (162, 7);
END INSERTAR_SERVICIOS_FACTURAS;
/

/* PROCEDIMIENTOS INSERCCION DE DATOS */

BEGIN
    INSERTAR_CLIENTES;
    INSERTAR_CATEGORIAS_SERVICIOS;
    INSERTAR_SERVICIOS;
    INSERTAR_FACTURAS;
    INSERTAR_SERVICIOS_FACTURAS;
END;
/

-------------------------------------------------------------------------------------------------------------------
------- 11.5 d - CREACION DE VISTAS CON DATOS DERIVADOS DE LAS TABLAS ---------
-------------------------------------------------------------------------------------------------------------------

/* VISTA DEL TOTAL GASTADO POR CADA CLIENTE EN SUS FACTURAS */

CREATE OR REPLACE VIEW VISTA_TOTAL_GASTADO_POR_CLIENTE AS
SELECT 
    C.ID_CLIENTE,
    C.DNI,
    C.NOMBRE,
    C.APELLIDOS,
    C.DIRECCION,
    C.TELEFONO,
    C.EMAIL,
    SUM(F.PRECIO_TOTAL) AS TOTAL_GASTADO
FROM 
    CLIENTES C
LEFT JOIN 
    FACTURAS F ON C.ID_CLIENTE = F.ID_CLIENTE
GROUP BY 
    C.ID_CLIENTE, C.DNI, C.NOMBRE, C.APELLIDOS, C.DIRECCION, C.TELEFONO, C.EMAIL
ORDER BY
    C.ID_CLIENTE;
    
    
SELECT * FROM VISTA_TOTAL_GASTADO_POR_CLIENTE;


/* VISTA TOTAL DE SERVICIOS Y TOTAL DE PRECIO */

CREATE OR REPLACE VIEW VISTA_SERVICIOS_SOLICITADOS AS
SELECT
    S.ID_SERVICIO,
    S.NOMBRE_SERVICIO,
    S.DESCRIPCION,
    COUNT(SF.ID_FACTURA) AS NUMERO_SOLICITUDES,
    SUM(S.PRECIO) AS INGRESO_TOTAL_GENERADO
FROM
    SERVICIOS S
    JOIN SERVICIOS_FACTURAS SF ON S.ID_SERVICIO = SF.ID_SERVICIO
    JOIN FACTURAS F ON SF.ID_FACTURA = F.ID_FACTURA
GROUP BY
    S.ID_SERVICIO, S.NOMBRE_SERVICIO, S.DESCRIPCION
ORDER BY
    S.ID_SERVICIO;
    

SELECT * FROM VISTA_SERVICIOS_SOLICITADOS;

-------------------------------------------------------------------------------------------------------------------
------- 11.6 a - ADICION DE DATOS VARIABLES EN TABLAS Y VISTAS ---------
-------------------------------------------------------------------------------------------------------------------

/* ADICION COLUMNA TIPO_CLIENTE EN CLIENTES CON DATOS CERRADOS */

ALTER TABLE CLIENTES ADD TIPO_CLIENTE VARCHAR2(15) CHECK (TIPO_CLIENTE IN ('Particular', 'Empresa'));

/* AÑADIMOS 2 CLIENTES CON TIPO_CLIENTE ASIGNADO (A FALTA DE LOS DEMÁS REGISTROS) */

INSERT INTO CLIENTES (DNI, NOMBRE, APELLIDOS, DIRECCION, TELEFONO, EMAIL, FECHA_REGISTRO, ESTADO_CLIENTE, TIPO_CLIENTE) VALUES ('31394485O', 'Logan', 'Naranjo Rodriguez', 'Calle Otoño 43', 613173456, 'logan.naranjo@gmail.com', '2024-06-09', 'Activo', 'Particular');
INSERT INTO CLIENTES (DNI, NOMBRE, APELLIDOS, DIRECCION, TELEFONO, EMAIL, FECHA_REGISTRO, ESTADO_CLIENTE, TIPO_CLIENTE) VALUES ('X7921153Y', 'Alejandro', 'Minguez Minguez', 'Av. Cloaca 2', 698587814, 'alejandro.minguez@outlook.com', '2024-06-09', 'Activo', 'Empresa');

INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (21, '2023-06-15', '2023-05-31', 94.98, 'Pendiente');
INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (163, 1);
INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (163, 4);
INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (163, 7);
INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO) VALUES (22, '2023-06-15', '2023-05-31', 69.98, 'Pendiente');
INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (164, 2);
INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (164, 5);

/* VISTA CLIENTE PARCIAL CON COLUMNA TIPO_CLIENTE */

CREATE OR REPLACE VIEW VISTA_CLIENTES_PARCIAL AS
SELECT
    C.ID_CLIENTE,
    C.NOMBRE,
    C.APELLIDOS,
    C.ESTADO_CLIENTE,
    F.FECHA_EMISION,
    F.FECHA_VENCIMIENTO,
    F.ID_FACTURA,
    F.ESTADO,
    COUNT(SF.ID_SERVICIO) AS NUMERO_SERVICIOS,
    SUM(S.PRECIO) AS PRECIO_TOTAL_SERVICIOS,
    C.TIPO_CLIENTE -- Incluye la nueva columna
FROM CLIENTES C
    INNER JOIN FACTURAS F ON C.ID_CLIENTE = F.ID_CLIENTE
    INNER JOIN SERVICIOS_FACTURAS SF ON F.ID_FACTURA = SF.ID_FACTURA
    INNER JOIN SERVICIOS S ON SF.ID_SERVICIO = S.ID_SERVICIO
GROUP BY
    C.ID_CLIENTE,
    C.NOMBRE,
    C.APELLIDOS,
    C.ESTADO_CLIENTE,
    F.FECHA_EMISION,
    F.FECHA_VENCIMIENTO,
    F.ID_FACTURA,
    F.ESTADO,
    C.TIPO_CLIENTE
ORDER BY
    C.ID_CLIENTE;
    
SELECT * FROM VISTA_CLIENTES_PARCIAL;     

/* UPDATE DE TODOS LOS DATOS DE LA COLUMNA TIPO_CLIENTE */

UPDATE CLIENTES SET TIPO_CLIENTE = CASE
    WHEN DNI LIKE 'X%' THEN 'Empresa' -- asigna 'Empresa' si el DNI empieza con 'X'
    ELSE 'Particular' 
END;

/* VISTA CLIENTES CON NUEVA COLUMNA TIPO_CLIENTE */

CREATE OR REPLACE VIEW VISTA_CLIENTES AS
SELECT 
    ID_CLIENTE, 
    DNI, 
    NOMBRE, 
    APELLIDOS, 
    DIRECCION, 
    TELEFONO, 
    EMAIL, 
    FECHA_REGISTRO, 
    ESTADO_CLIENTE, 
    TIPO_CLIENTE -- Incluye la nueva columna
FROM CLIENTES;

SELECT * FROM VISTA_CLIENTES;

-------------------------------------------------------------------------------------------------------------------

/* ADICION COLUMNA COMENTARIOS EN FACTURAS CON DATOS ABIERTOS */

ALTER TABLE FACTURAS ADD COMENTARIOS VARCHAR2(200);


/* AÑADO UNA FACTURA AL CLIENTE 1 CON SU COMENTARIO */

INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO, COMENTARIOS) VALUES (1, '2024-06-15', '2024-06-30', 50.97, 'Pendiente', 'COMENTARIO DE PRUEBA');
INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (165, 1);
INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (165, 4);
INSERT INTO SERVICIOS_FACTURAS (ID_FACTURA, ID_SERVICIO) VALUES (165, 7);

/* MUESTRO LA VISTA PARCIAL DE FACTURAS DEL CLIENTE 1 */

CREATE OR REPLACE VIEW VISTA_FACTURAS_PARCIAL AS
SELECT 
    ID_FACTURA, 
    ID_CLIENTE, 
    FECHA_EMISION, 
    FECHA_VENCIMIENTO, 
    ESTADO, 
    COMENTARIOS -- Incluye la nueva columna
FROM 
    FACTURAS
WHERE
    ID_CLIENTE = 1;


SELECT * FROM VISTA_FACTURAS;

/* UPDATE DE DATOS ALEATORIOS DE LA COLUMNA COMENTARIOS A TODOS */

UPDATE FACTURAS SET COMENTARIOS = CASE 
    WHEN COMENTARIOS IS NULL OR COMENTARIOS = '' THEN 
        CASE 
            WHEN DBMS_RANDOM.VALUE < 0.2 THEN 'Cliente solicitó extensión de plazo'
            WHEN DBMS_RANDOM.VALUE < 0.4 THEN 'Descuento aplicado por promoción'
            WHEN DBMS_RANDOM.VALUE < 0.6 THEN 'Revisión manual necesaria'
            WHEN DBMS_RANDOM.VALUE < 0.8 THEN 'Factura enviada por correo'
            ELSE 'Sin comentarios'
        END
    ELSE 
        COMENTARIOS
END;

/* VISTA FACTURAS COMPLETA CON NUEVA COLUMNA COMENTARIOS */

CREATE OR REPLACE VIEW VISTA_FACTURAS AS
SELECT 
    ID_FACTURA, 
    ID_CLIENTE, 
    FECHA_EMISION, 
    FECHA_VENCIMIENTO, 
    ESTADO, 
    COMENTARIOS -- Incluye la nueva columna
FROM 
    FACTURAS
WHERE
    ID_CLIENTE = 1;


SELECT * FROM VISTA_FACTURAS;

-------------------------------------------------------------------------------------------------------------------
--------- 11.6 b - ADICION DE DATOS NUMERICOS CUANTIFICABLES EN TABLAS Y VISTAS ---------
-------------------------------------------------------------------------------------------------------------------

/* ADICION COLUMNA DIAS_REGISTRADO EN CLIENTES */

ALTER TABLE CLIENTES ADD DIAS_REGISTRADO NUMBER;

/* UPDATE DE LOS DATOS DE LA COLUMNA DIAS_REGISTRADO */

UPDATE CLIENTES SET DIAS_REGISTRADO = TRUNC(SYSDATE - FECHA_REGISTRO);

/* VISTA CLIENTES CON NUEVA COLUMNA CUANTIFICABLE */

CREATE OR REPLACE VIEW VISTA_CLIENTES AS
SELECT 
    ID_CLIENTE, 
    DNI, 
    NOMBRE, 
    APELLIDOS, 
    DIRECCION, 
    TELEFONO, 
    EMAIL, 
    FECHA_REGISTRO, 
    ESTADO_CLIENTE, 
    TIPO_CLIENTE, 
    DIAS_REGISTRADO -- Incluye la nueva columna cuantificable
FROM CLIENTES;

SELECT * FROM VISTA_CLIENTES;

---------------------------------------------------------------------------------------------------------------
------------------- UTILIZANDO PROCEDIMIENTOS PARA CALCULAR DESCUENTOS ----------------------------------------
---------------------------------------------------------------------------------------------------------------

/* ADICION COLUMNA DESCUENTO EN FACTURAS */

ALTER TABLE FACTURAS ADD (DESCUENTO NUMBER(5, 2) DEFAULT 0);

/* VISTA DONDE SE VEN LAS FACTURAS DE LOS CLIENTES */


CREATE OR REPLACE VIEW VISTA_TOTAL_GASTADO_POR_CLIENTE AS
SELECT 
    C.ID_CLIENTE,
    C.DNI,
    C.NOMBRE,
    C.APELLIDOS,
    C.DIRECCION,
    C.TELEFONO,
    C.EMAIL,
    SUM(F.PRECIO_TOTAL) AS TOTAL_GASTADO,
    F.DESCUENTO
FROM 
    CLIENTES C
LEFT JOIN 
    FACTURAS F ON C.ID_CLIENTE = F.ID_CLIENTE
GROUP BY 
    C.ID_CLIENTE, C.DNI, C.NOMBRE, C.APELLIDOS, C.DIRECCION, C.TELEFONO, C.EMAIL, F.DESCUENTO
ORDER BY
    C.ID_CLIENTE;
    
    
SELECT * FROM VISTA_TOTAL_GASTADO_POR_CLIENTE;

/* PROCEDIMIENTO PARA APLICAR LOS DESCUENTOS */

CREATE OR REPLACE PROCEDURE APLICAR_DESCUENTOS IS
    CURSOR c_clientes IS
        SELECT ID_CLIENTE, FECHA_REGISTRO
        FROM CLIENTES;
        
    v_id_cliente CLIENTES.ID_CLIENTE%TYPE;
    v_fecha_registro CLIENTES.FECHA_REGISTRO%TYPE;
    v_fecha_actual DATE := SYSDATE;
    v_descuento NUMBER(5, 2);

BEGIN
    FOR cliente IN c_clientes LOOP
        v_id_cliente := cliente.ID_CLIENTE;
        v_fecha_registro := cliente.FECHA_REGISTRO;
        
        -- Calcular el tiempo que lleva registrado
        IF MONTHS_BETWEEN(v_fecha_actual, v_fecha_registro) > 12 THEN
            v_descuento := 15;
        ELSIF MONTHS_BETWEEN(v_fecha_actual, v_fecha_registro) > 6 THEN
            v_descuento := 10;
        ELSIF MONTHS_BETWEEN(v_fecha_actual, v_fecha_registro) >= 3 THEN
            v_descuento := 5;
        ELSE
            v_descuento := 0; -- Sin descuento si lleva menos de 3 meses
        END IF;
        
        -- Actualizar las facturas del cliente con el descuento correspondiente
        UPDATE FACTURAS SET DESCUENTO = v_descuento,
            PRECIO_TOTAL = PRECIO_TOTAL * (1 - v_descuento / 100)
        WHERE ID_CLIENTE = v_id_cliente
        AND ESTADO = 'Pendiente';
    END LOOP;
END;
/


BEGIN
    APLICAR_DESCUENTOS;
END;


/* VISTA MOSTRANDO LOS DESCUENTOS Y LOS PRECIOS TOTALES MODIFICADOS */

CREATE OR REPLACE VIEW VISTA_FACTURAS_DESCUENTO AS
SELECT 
    C.ID_CLIENTE,
    C.DNI,
    C.NOMBRE,
    C.APELLIDOS,
    C.DIRECCION,
    C.TELEFONO,
    C.EMAIL,
    SUM(F.PRECIO_TOTAL) AS TOTAL_GASTADO_SIN_DESCUENTO,
    SUM(F.PRECIO_TOTAL * (1 - F.DESCUENTO / 100)) AS TOTAL_GASTADO_CON_DESCUENTO,
    MAX(F.DESCUENTO) AS DESCUENTO,
    (SELECT COUNT(*) FROM FACTURAS F2 WHERE F2.ID_CLIENTE = C.ID_CLIENTE AND F2.ESTADO = 'Pendiente') AS FACTURAS_PENDIENTES
FROM 
    CLIENTES C
INNER JOIN 
    FACTURAS F ON C.ID_CLIENTE = F.ID_CLIENTE
GROUP BY 
    C.ID_CLIENTE, C.DNI, C.NOMBRE, C.APELLIDOS, C.DIRECCION, C.TELEFONO, C.EMAIL
ORDER BY
    C.ID_CLIENTE;
    

SELECT * FROM VISTA_FACTURAS_DESCUENTO;     

------------------------------------------------------------------------------------------------------------------
---------------------------- UTILIZANDO FUNCIONES PARA CALCULAR DESCUENTOS ---------------------------------------
------------------------------------------------------------------------------------------------------------------

/* TAMBIEN SE PUEDE UTILIZAR UNA FUNCION, QUE DEVUELVE EL TIPO DE DESCUENTO PARA DESPUES APLICARLO EN LAS CONSULTAS */

CREATE OR REPLACE FUNCTION CALCULAR_DESCUENTO (fecha_registro DATE) RETURN NUMBER IS
    v_fecha_actual DATE := SYSDATE;
    v_descuento NUMBER(5, 2);
BEGIN
    -- Calcular el tiempo que lleva registrado
    IF MONTHS_BETWEEN(v_fecha_actual, fecha_registro) > 12 THEN
        v_descuento := 15;
    ELSIF MONTHS_BETWEEN(v_fecha_actual, fecha_registro) > 6 THEN
        v_descuento := 10;
    ELSIF MONTHS_BETWEEN(v_fecha_actual, fecha_registro) >= 3 THEN
        v_descuento := 5;
    ELSE
        v_descuento := 0;
    END IF;
    RETURN v_descuento;
END CALCULAR_DESCUENTO;

-- Ejemplo de un SELECT
SELECT C.ID_CLIENTE, C.NOMBRE, C.APELLIDOS, C.FECHA_REGISTRO, TRUNC(MONTHS_BETWEEN(SYSDATE, C.FECHA_REGISTRO)) AS MESES_REGISTRADO, 
SUM(F.PRECIO_TOTAL) AS TOTAL_GASTADO, SUM(F.PRECIO_TOTAL) - SUM(F.PRECIO_TOTAL)*CALCULAR_DESCUENTO(C.FECHA_REGISTRO)/100 AS TOTAL_GASTADO_CON_DESCUENTO,
CALCULAR_DESCUENTO(C.FECHA_REGISTRO) AS DESCUENTO 
FROM CLIENTES C 
INNER JOIN FACTURAS F ON C.ID_CLIENTE = F.ID_CLIENTE
GROUP BY C.ID_CLIENTE, C.NOMBRE, C.APELLIDOS, C.FECHA_REGISTRO, F.ESTADO
HAVING F.ESTADO = 'Pendiente'
ORDER BY C.ID_CLIENTE;

---------------------------------------------------------------------------------------------------------------
---------------------------------------- UTILIZANDO TRIGGERS --------------------------------------------------
---------------------------------------------------------------------------------------------------------------

------------- a) EVENTO DE INSTRUCCION EN EL QUE SE MODIFICA UNA COLUMNA A PARTIR DE CIERTO EVENTO ------------

/* TRIGGER PARA ACTUALIZAR UN CAMPO NUEVO LLAMADO MODIFICACIONES EN LA TABLA CLIENTES CUANDO SE MODIFIQUE EL TELEFONO */
/* CREACION COLUMNA MODIFICACIONES EN CLIENTES */
ALTER TABLE CLIENTES ADD (MODIFICACIONES VARCHAR2(100));

/* CREACION DEL TRIGGER */
CREATE OR REPLACE TRIGGER TRIGGER_MODIFICACION_TELEFONO
BEFORE UPDATE OF TELEFONO ON CLIENTES
FOR EACH ROW
BEGIN
    IF :OLD.TELEFONO <> :NEW.TELEFONO THEN
        :NEW.MODIFICACIONES := 'Telefono modificado el ' || TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS');
    END IF;
END;
/

/* EJEMPLO DE MODIFICACION DE TELEFONO */
UPDATE CLIENTES SET TELEFONO = 620123456 WHERE ID_CLIENTE = 1;

/* AQUI SE MUESTRA COMO SE RELLENA EL CAMPO MODIFICACIONES */
SELECT ID_CLIENTE, NOMBRE, APELLIDOS, DIRECCION, TELEFONO, EMAIL, MODIFICACIONES FROM CLIENTES;

/* EJEMPLO DE MODIFICACION DE OTRO TELEFONO */
UPDATE CLIENTES SET TELEFONO = 643987655 WHERE ID_CLIENTE = 3;

/* SE VUELVE A MOSTRAR LA MODIFICACION */
SELECT ID_CLIENTE, NOMBRE, APELLIDOS, DIRECCION, TELEFONO, EMAIL, MODIFICACIONES FROM CLIENTES;


------------- b) EVENTO QUE IMPLIQUE LA DIFERENCIACION ENTRE INSERCCION, MODIFICACION, O BORRADO ------------
----------------------------------------- C) EVENTO DE FILA  ------------------------------------------------

/* CREACION DE  TABLA LLAMADA CLIENTES_LOG */

CREATE TABLE CLIENTES_LOG (
    ID_LOG NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ID_CLIENTE NUMBER,
    OPERACION VARCHAR2(100),
    FECHA TIMESTAMP,
    CAMBIO VARCHAR2(200)
);

/* TRIGGER PARA AUDITAR CAMBIOS EN LA TABLA CLIENTES */

CREATE OR REPLACE TRIGGER CLIENTES_LOG_TRIGGER
AFTER INSERT OR UPDATE OR DELETE ON CLIENTES
FOR EACH ROW
BEGIN
    IF INSERTING THEN
        INSERT INTO CLIENTES_LOG (ID_CLIENTE, OPERACION, FECHA, CAMBIO)
        VALUES (:NEW.ID_CLIENTE, 'INSERCIÓN', SYSTIMESTAMP, 'Nuevo cliente insertado');
    ELSIF UPDATING THEN
        INSERT INTO CLIENTES_LOG (ID_CLIENTE, OPERACION, FECHA, CAMBIO)
        VALUES (:NEW.ID_CLIENTE, 'MODIFICACIÓN', SYSTIMESTAMP, 'Cliente modificado');
    ELSIF DELETING THEN
        INSERT INTO CLIENTES_LOG (ID_CLIENTE, OPERACION, FECHA, CAMBIO)
        VALUES (:OLD.ID_CLIENTE, 'BORRADO', SYSTIMESTAMP, 'Cliente borrado');
    END IF;
END;
/

/* EJEMPLOS DE INSERCCION, MODIFICACION Y BORRADO DE CLIENTES */

-- Inserción
INSERT INTO CLIENTES (DNI, NOMBRE, APELLIDOS, DIRECCION, TELEFONO, EMAIL, FECHA_REGISTRO, ESTADO_CLIENTE) VALUES ('11111111A', 'Test', 'User', 'Calle Prueba 1', 610000000, 'test.user@gmail.com', '2024-06-04', 'Activo');

-- Modificación
UPDATE CLIENTES SET TELEFONO = 620000000 WHERE DNI = '11111111A';

-- Borrado
DELETE FROM CLIENTES WHERE DNI = '11111111A';

/* CONSULTA DE LA TABLA CLIENTES_LOG */

SELECT 
    ID_LOG,
    ID_CLIENTE,
    OPERACION,
    TO_CHAR(FECHA, 'YYYY-MM-DD HH24:MI:SS') AS FECHA,
    CAMBIO
FROM 
    CLIENTES_LOG;



---------------- d) EVENTO DE INSTEAD OF PARA QUE SE INTENTE HACER UN INSERT SOBRE LA TABLA Y EL EVENTO LO TRANSFORME EN DOS O MÁS INSERCCIONES EN LAS TABLAS CORRESPONDIENTES ----------------

/* CREACION DE LA VISTA ENTRE CLIENTES Y FACTURAS */
CREATE OR REPLACE VIEW VISTA_CLIENTES_FACTURAS AS
SELECT 
    C.ID_CLIENTE,
    C.DNI,
    C.NOMBRE,
    C.APELLIDOS,
    C.DIRECCION,
    C.TELEFONO,
    C.EMAIL,
    C.FECHA_REGISTRO,
    C.ESTADO_CLIENTE,
    C.TIPO_CLIENTE,
    C.DIAS_REGISTRADO,
    C.MODIFICACIONES,
    F.ID_FACTURA,
    F.FECHA_EMISION,
    F.FECHA_VENCIMIENTO,
    F.PRECIO_TOTAL,
    F.ESTADO AS ESTADO_FACTURA,
    F.COMENTARIOS,
    F.DESCUENTO
FROM 
    CLIENTES C
LEFT JOIN 
    FACTURAS F ON C.ID_CLIENTE = F.ID_CLIENTE
ORDER BY 
    C.ID_CLIENTE;    


SELECT * FROM VISTA_CLIENTES_FACTURAS;    
    

/* CREACION DE TRIGGER INSTEAD OF INSERT PARA LA VISTA CLIENTES_FACTURAS */
CREATE OR REPLACE TRIGGER VISTA_CLIENTES_FACTURAS_INSERT_TRIGGER
INSTEAD OF INSERT ON VISTA_CLIENTES_FACTURAS
FOR EACH ROW
DECLARE
    v_id_cliente NUMBER;
    v_id_factura NUMBER;
    v_dias_registrado NUMBER;
    v_descuento NUMBER;
BEGIN
    -- Calcular los días registrados
    v_dias_registrado := TRUNC(SYSDATE - :NEW.FECHA_REGISTRO);
    -- Calcular el descuento, asumiendo que CALCULAR_DESCUENTO es una función definida en la base de datos
    v_descuento := CALCULAR_DESCUENTO(:NEW.FECHA_REGISTRO);
    -- Insertar en la tabla CLIENTES
    INSERT INTO CLIENTES (DNI, NOMBRE, APELLIDOS, DIRECCION, TELEFONO, EMAIL, FECHA_REGISTRO, ESTADO_CLIENTE, TIPO_CLIENTE, DIAS_REGISTRADO, MODIFICACIONES)
    VALUES (:NEW.DNI, :NEW.NOMBRE, :NEW.APELLIDOS, :NEW.DIRECCION, :NEW.TELEFONO, :NEW.EMAIL, :NEW.FECHA_REGISTRO, :NEW.ESTADO_CLIENTE, :NEW.TIPO_CLIENTE, 
            v_dias_registrado, :NEW.MODIFICACIONES)
    RETURNING ID_CLIENTE INTO v_id_cliente;
    -- Insertar en la tabla FACTURAS
    INSERT INTO FACTURAS (ID_CLIENTE, FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO, COMENTARIOS, DESCUENTO)
    VALUES (v_id_cliente, :NEW.FECHA_EMISION, :NEW.FECHA_VENCIMIENTO, :NEW.PRECIO_TOTAL, :NEW.ESTADO_FACTURA, :NEW.COMENTARIOS, v_descuento)
    RETURNING ID_FACTURA INTO v_id_factura;
END;
/

/* INSERTAMOS DATOS A LA VISTA CLIENTES_FACTURAS CON EL TRIGGER */
INSERT INTO VISTA_CLIENTES_FACTURAS (DNI, NOMBRE, APELLIDOS, DIRECCION, TELEFONO, EMAIL, FECHA_REGISTRO, ESTADO_CLIENTE, TIPO_CLIENTE, DIAS_REGISTRADO, MODIFICACIONES, 
FECHA_EMISION, FECHA_VENCIMIENTO, PRECIO_TOTAL, ESTADO_FACTURA, COMENTARIOS, DESCUENTO) 
VALUES ('12345678C', 'Enrique', 'Martí', 'Calle del Aprobado, 69', '987614621', 'enrique.marti@hotmail.com', SYSDATE, 'Activo', 'Particular', NULL, 'Sin modificaciones', 
TO_DATE('2024-06-15', 'YYYY-MM-DD'), TO_DATE('2024-06-30', 'YYYY-MM-DD'), 1000.00, 'Pendiente', 'Sin comentarios', NULL);

/* COMPROBAMOS QUE SE HAN INSERTADO LOS DATOS EN LAS TABLAS CLIENTES Y FACTURAS */
SELECT * FROM CLIENTES WHERE NOMBRE = 'Enrique';
SELECT * FROM FACTURAS WHERE PRECIO_TOTAL = 1000.00;


---------------------------------------------------------------------------------------------------------------
-------------------------------------------------------- FIN --------------------------------------------------
---------------------------------------------------------------------------------------------------------------